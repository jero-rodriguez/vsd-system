<div class="vsd-character-sheet">
  <div class="vsd-character-card">

    <header class="sheet-header">
      <h1 class="charname">
        <input name="name" type="text" value="{{actor.name}}" placeholder="Character Name" />
      </h1>
    </header>

    <fieldset class="vsd-fieldset">
      <legend>Identity</legend>

      <div class="vsd-grid vsd-grid--6">
        <div class="vsd-cell">
          <label>Level</label>
          <input type="number" name="system.identity.level" value="{{system.identity.level}}" min="1" />
        </div>
        <div class="vsd-cell">
          <label>XP</label>
          <input type="number" name="system.identity.xp" value="{{system.identity.xp}}" min="0" />
        </div>

        <div class="vsd-cell">
          <label>Kin</label>
          <input type="text" name="system.identity.kin.name" value="{{system.identity.kin.name}}" />
        </div>
        <div class="vsd-cell">
          <label>Culture</label>
          <input type="text" name="system.identity.culture.name" value="{{system.identity.culture.name}}" />
        </div>
        <div class="vsd-cell">
          <label>Vocation</label>
          <input type="text" name="system.identity.vocation.name" value="{{system.identity.vocation.name}}" />
        </div>
      </div>
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Stats</legend>

      <div class="vsd-grid vsd-grid--6">
        <div class="vsd-cell">
          <label title="Brawn">BRN</label>
          <input type="number" name="system.stats.brawn.base" value="{{system.stats.brawn.base}}" step="5" />
          <input type="number" name="system.stats.brawn.spec" value="{{system.stats.brawn.spec}}" step="5" />
          <div class="vsd-readonly">Total: {{system.derived.stats.brawn.total}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Swiftness">SWI</label>
          <input type="number" name="system.stats.swiftness.base" value="{{system.stats.swiftness.base}}" step="5" />
          <input type="number" name="system.stats.swiftness.spec" value="{{system.stats.swiftness.spec}}" step="5" />
          <div class="vsd-readonly">Total: {{system.derived.stats.swiftness.total}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Fortitude">FOR</label>
          <input type="number" name="system.stats.fortitude.base" value="{{system.stats.fortitude.base}}" step="5" />
          <input type="number" name="system.stats.fortitude.spec" value="{{system.stats.fortitude.spec}}" step="5" />
          <div class="vsd-readonly">Total: {{system.derived.stats.fortitude.total}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Wits">WIT</label>
          <input type="number" name="system.stats.wits.base" value="{{system.stats.wits.base}}" step="5" />
          <input type="number" name="system.stats.wits.spec" value="{{system.stats.wits.spec}}" step="5" />
          <div class="vsd-readonly">Total: {{system.derived.stats.wits.total}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Wisdom">WSD</label>
          <input type="number" name="system.stats.wisdom.base" value="{{system.stats.wisdom.base}}" step="5" />
          <input type="number" name="system.stats.wisdom.spec" value="{{system.stats.wisdom.spec}}" step="5" />
          <div class="vsd-readonly">Total: {{system.derived.stats.wisdom.total}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Bearing">BEA</label>
          <input type="number" name="system.stats.bearing.base" value="{{system.stats.bearing.base}}" step="5" />
          <input type="number" name="system.stats.bearing.spec" value="{{system.stats.bearing.spec}}" step="5" />
          <div class="vsd-readonly">Total: {{system.derived.stats.bearing.total}}</div>
        </div>
      </div>
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Vitals</legend>

      <div class="vsd-grid vsd-grid--6">
        <div class="vsd-cell">
          <label title="Hit Points (Current)">HP</label>
          <input type="number" name="system.hitPoints.current" value="{{system.hitPoints.current}}" min="0" />
          <div class="vsd-readonly">Total: {{system.derived.hitPoints.total}}</div>
          <div class="vsd-readonly">Max: {{system.derived.hitPoints.max}}</div>
          <div class="vsd-readonly">Cap: {{system.derived.hitPoints.capacity}}</div>
          <div class="vsd-readonly">Bruise: {{system.derived.hitPoints.bruiseThreshold}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Magic Points (Current)">MP</label>
          <input type="number" name="system.magicPoints.current" value="{{system.magicPoints.current}}" min="0" />
          <div class="vsd-readonly">Total: {{system.derived.magicPoints.total}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Total Saving Roll">TSR</label>
          <div class="vsd-readonly">{{system.derived.saves.tsr}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Will Saving Roll">WSR</label>
          <div class="vsd-readonly">{{system.derived.saves.wsr}}</div>
        </div>

        <div class="vsd-cell">
          <label title="Movement Rate">Move</label>
          <div class="vsd-readonly">{{system.derived.movement.rate}}</div>
        </div>
      </div>
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Skills</legend>

      {{#each system.skills as |category catKey|}}
      <div class="vsd-skill-category">
        <h3>{{catKey}}</h3>

        {{#each category.skills as |skill skillKey|}}
        <div class="vsd-grid vsd-grid--6 vsd-skill-row">
          <div class="vsd-cell">
            <label>{{skillKey}}</label>
          </div>

          <div class="vsd-cell">
            <label>Ranks</label>
            <input type="number" name="system.skills.{{catKey}}.skills.{{skillKey}}.ranks" value="{{skill.ranks}}"
              min="0" />
          </div>

          <div class="vsd-cell">
            <label>Spec</label>
            <input type="number" name="system.skills.{{catKey}}.skills.{{skillKey}}.spec" value="{{skill.spec}}" />
          </div>

          <div class="vsd-cell">
            <label>Rank Bonus</label>
            <div class="vsd-readonly">{{lookup ../../system.derived.skills skillKey "rankBonus"}}</div>
          </div>

          <div class="vsd-cell">
            <label>Total</label>
            <div class="vsd-readonly">{{lookup ../../system.derived.skills skillKey "total"}}</div>
          </div>
        </div>
        {{/each}}
      </div>
      {{/each}}
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Spell Lores</legend>

      {{#each system.spellLores as |lore idx|}}
      <div class="vsd-grid vsd-grid--6 vsd-lore-row">
        <div class="vsd-cell">
          <label>Name</label>
          <input type="text" name="system.spellLores.{{idx}}.name" value="{{lore.name}}" />
        </div>

        <div class="vsd-cell">
          <label>Ranks</label>
          <input type="number" name="system.spellLores.{{idx}}.ranks" value="{{lore.ranks}}" min="0" />
        </div>

        <div class="vsd-cell">
          <label>Rank Bonus</label>
          <div class="vsd-readonly">{{get ../system (concat "derived.spellLores." idx ".rankBonus")}}</div>
        </div>

        <div class="vsd-cell">
          <label>Total</label>
          <div class="vsd-readonly">{{get ../system (concat "derived.spellLores." idx ".total")}}</div>
        </div>

        <div class="vsd-cell">
          <label>Known Spells</label>
          <textarea name="system.spellLores.{{idx}}.knownSpells" rows="2">{{lore.knownSpells}}</textarea>
        </div>
      </div>
      {{/each}}
    </fieldset>

  </div>
</div>