<div class="vsd-sheet vsd-sheet--character">
  <div class="vsd-sheet__card">

    <header class="sheet-header">
      <h1 class="charname">
        <input name="name" type="text" value="{{actor.name}}" placeholder="Character Name" />
      </h1>
    </header>

    <fieldset class="vsd-fieldset">
      <legend>Identity</legend>

      <div class="vsd-grid vsd-grid--identity">
        <div class="vsd-cell">
          <label>Level</label>
          <input type="number" name="system.identity.level" value="{{system.identity.level}}" min="1" />
        </div>

        <div class="vsd-cell">
          <label>XP</label>
          <input type="number" name="system.identity.xp" value="{{system.identity.xp}}" min="0" />
        </div>

        <div class="vsd-cell">
          <label>Kin</label>
          <input type="text" name="system.identity.kin.name" value="{{system.identity.kin.name}}" />
        </div>

        <div class="vsd-cell">
          <label>Culture</label>
          <input type="text" name="system.identity.culture.name" value="{{system.identity.culture.name}}" />
        </div>

        <div class="vsd-cell">
          <label>Vocation</label>
          <input type="text" name="system.identity.vocation.name" value="{{system.identity.vocation.name}}" />
        </div>
      </div>
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Stats</legend>

      <div class="vsd-cards vsd-cards--stats">
        <div class="vsd-cardStat">
          <div class="vsd-cardStat__head">
            <span class="vsd-abbr" title="Brawn">BRN</span>
            <span class="vsd-pill">{{system.derived.stats.brawn.total}}</span>
          </div>
          <div class="vsd-cardStat__body">
            <label class="vsd-subLabel">Base
              <input type="number" name="system.stats.brawn.base" value="{{system.stats.brawn.base}}" step="5" />
            </label>
            <label class="vsd-subLabel">Spec
              <input type="number" name="system.stats.brawn.spec" value="{{system.stats.brawn.spec}}" step="5" />
            </label>
          </div>
        </div>

        <div class="vsd-cardStat">
          <div class="vsd-cardStat__head">
            <span class="vsd-abbr" title="Swiftness">SWI</span>
            <span class="vsd-pill">{{system.derived.stats.swiftness.total}}</span>
          </div>
          <div class="vsd-cardStat__body">
            <label class="vsd-subLabel">Base
              <input type="number" name="system.stats.swiftness.base" value="{{system.stats.swiftness.base}}"
                step="5" />
            </label>
            <label class="vsd-subLabel">Spec
              <input type="number" name="system.stats.swiftness.spec" value="{{system.stats.swiftness.spec}}"
                step="5" />
            </label>
          </div>
        </div>

        <div class="vsd-cardStat">
          <div class="vsd-cardStat__head">
            <span class="vsd-abbr" title="Fortitude">FOR</span>
            <span class="vsd-pill">{{system.derived.stats.fortitude.total}}</span>
          </div>
          <div class="vsd-cardStat__body">
            <label class="vsd-subLabel">Base
              <input type="number" name="system.stats.fortitude.base" value="{{system.stats.fortitude.base}}"
                step="5" />
            </label>
            <label class="vsd-subLabel">Spec
              <input type="number" name="system.stats.fortitude.spec" value="{{system.stats.fortitude.spec}}"
                step="5" />
            </label>
          </div>
        </div>

        <div class="vsd-cardStat">
          <div class="vsd-cardStat__head">
            <span class="vsd-abbr" title="Wits">WIT</span>
            <span class="vsd-pill">{{system.derived.stats.wits.total}}</span>
          </div>
          <div class="vsd-cardStat__body">
            <label class="vsd-subLabel">Base
              <input type="number" name="system.stats.wits.base" value="{{system.stats.wits.base}}" step="5" />
            </label>
            <label class="vsd-subLabel">Spec
              <input type="number" name="system.stats.wits.spec" value="{{system.stats.wits.spec}}" step="5" />
            </label>
          </div>
        </div>

        <div class="vsd-cardStat">
          <div class="vsd-cardStat__head">
            <span class="vsd-abbr" title="Wisdom">WSD</span>
            <span class="vsd-pill">{{system.derived.stats.wisdom.total}}</span>
          </div>
          <div class="vsd-cardStat__body">
            <label class="vsd-subLabel">Base
              <input type="number" name="system.stats.wisdom.base" value="{{system.stats.wisdom.base}}" step="5" />
            </label>
            <label class="vsd-subLabel">Spec
              <input type="number" name="system.stats.wisdom.spec" value="{{system.stats.wisdom.spec}}" step="5" />
            </label>
          </div>
        </div>

        <div class="vsd-cardStat">
          <div class="vsd-cardStat__head">
            <span class="vsd-abbr" title="Bearing">BEA</span>
            <span class="vsd-pill">{{system.derived.stats.bearing.total}}</span>
          </div>
          <div class="vsd-cardStat__body">
            <label class="vsd-subLabel">Base
              <input type="number" name="system.stats.bearing.base" value="{{system.stats.bearing.base}}" step="5" />
            </label>
            <label class="vsd-subLabel">Spec
              <input type="number" name="system.stats.bearing.spec" value="{{system.stats.bearing.spec}}" step="5" />
            </label>
          </div>
        </div>
      </div>
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Vitals</legend>

      <div class="vsd-cards vsd-cards--vitals">
        <div class="vsd-cardVital">
          <div class="vsd-cardVital__head">
            <span class="vsd-abbr" title="Hit Points (Current)">HP</span>
            <input class="vsd-compactInput" type="number" name="system.hitPoints.current"
              value="{{system.hitPoints.current}}" min="0" />
          </div>
          <div class="vsd-cardVital__meta">
            <div>Total <span class="vsd-pill">{{system.derived.hitPoints.total}}</span></div>
            <div>Max <span class="vsd-pill">{{system.derived.hitPoints.max}}</span></div>
            <div>Cap <span class="vsd-pill">{{system.derived.hitPoints.capacity}}</span></div>
            <div>Bruise <span class="vsd-pill">{{system.derived.hitPoints.bruiseThreshold}}</span></div>
          </div>
        </div>

        <div class="vsd-cardVital">
          <div class="vsd-cardVital__head">
            <span class="vsd-abbr" title="Magic Points (Current)">MP</span>
            <input class="vsd-compactInput" type="number" name="system.magicPoints.current"
              value="{{system.magicPoints.current}}" min="0" />
          </div>
          <div class="vsd-cardVital__meta">
            <div>Total <span class="vsd-pill">{{system.derived.magicPoints.total}}</span></div>
          </div>
        </div>

        <div class="vsd-cardVital">
          <div class="vsd-cardVital__head">
            <span class="vsd-abbr" title="Total Saving Roll">TSR</span>
            <span class="vsd-pill">{{system.derived.saves.tsr}}</span>
          </div>
        </div>

        <div class="vsd-cardVital">
          <div class="vsd-cardVital__head">
            <span class="vsd-abbr" title="Will Saving Roll">WSR</span>
            <span class="vsd-pill">{{system.derived.saves.wsr}}</span>
          </div>
        </div>

        <div class="vsd-cardVital">
          <div class="vsd-cardVital__head">
            <span class="vsd-abbr" title="Movement Rate">Move</span>
            <span class="vsd-pill">{{system.derived.movement.rate}}</span>
          </div>
        </div>
      </div>
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Skills</legend>

      {{#each system.skills as |category catKey|}}
      <div class="vsd-skill-category">
        <h3>{{catKey}}</h3>

        <table class="vsd-table">
          <thead>
            <tr>
              <th class="is-wide">Skill</th>
              <th class="is-compact is-center">Ranks</th>
              <th class="is-compact is-center">Spec</th>
              <th class="is-compact is-center">Rank Bonus</th>
              <th class="is-compact is-center">Total</th>
            </tr>
          </thead>
          <tbody>
            {{#each category.skills as |skill skillKey|}}
            <tr>
              <td title="{{skillKey}}">{{skillKey}}</td>

              <td class="is-compact">
                <input type="number" name="system.skills.{{catKey}}.skills.{{skillKey}}.ranks" value="{{skill.ranks}}"
                  min="0" />
              </td>

              <td class="is-compact">
                <input type="number" name="system.skills.{{catKey}}.skills.{{skillKey}}.spec" value="{{skill.spec}}" />
              </td>

              <td class="is-compact is-center">
                <div class="vsd-readonly">{{get ../../system (concat "derived.skills." skillKey ".rankBonus")}}</div>
              </td>

              <td class="is-compact is-center">
                <div class="vsd-readonly">{{get ../../system (concat "derived.skills." skillKey ".total")}}</div>
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>
      {{/each}}
    </fieldset>

    <fieldset class="vsd-fieldset">
      <legend>Spell Lores</legend>

      <table class="vsd-table">
        <thead>
          <tr>
            <th class="is-wide">Name</th>
            <th class="is-compact is-center">Ranks</th>
            <th class="is-compact is-center">Rank Bonus</th>
            <th class="is-compact is-center">Total</th>
            <th>Known Spells</th>
          </tr>
        </thead>
        <tbody>
          {{#each system.spellLores as |lore idx|}}
          <tr>
            <td>
              <input type="text" name="system.spellLores.{{idx}}.name" value="{{lore.name}}" />
            </td>

            <td class="is-compact">
              <input type="number" name="system.spellLores.{{idx}}.ranks" value="{{lore.ranks}}" min="0" />
            </td>

            <td class="is-compact is-center">
              <div class="vsd-readonly">{{get ../system (concat "derived.spellLores." idx ".rankBonus")}}</div>
            </td>

            <td class="is-compact is-center">
              <div class="vsd-readonly">{{get ../system (concat "derived.spellLores." idx ".total")}}</div>
            </td>

            <td>
              <div class="vsd-knownSpells">
                {{#each lore.knownSpells as |s|}}
                <div>{{s}}</div>
                {{/each}}
              </div>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </fieldset>

  </div>
</div>